import Link from "next/link";
import MaxWidthWrapper from "./MaxWidthWrapper";
import { buttonVariants } from "./ui/button";
import {
  LoginLink,
  RegisterLink,
  getKindeServerSession,
} from "@kinde-oss/kinde-auth-nextjs/server";
import { ArrowRight } from "lucide-react";
import UserAccountNav from "./UserAccountNav";
import MobileNav from "./MobileNav";

const Navbar = () => {
  const { getUser } = getKindeServerSession();
  const user = getUser();

  return (
    <nav className="sticky h-14 inset-x-0 top-0 z-30 w-full border-b border-gray-200 bg-white/75 backdrop-blur-lg transition-all">
      <MaxWidthWrapper>
        <div className="flex h-14 items-center justify-between border-b border-zinc-200">
          <Link href="/" className="flex z-40 font-semibold">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              version="1.1"
              xmlnsXlink="http://www.w3.org/1999/xlink"
              xmlLang="http://svgjs.dev/svgjs"
              width="118"
              height="32"
              viewBox="0 0 1180 320"
            >
              <g transform="matrix(1,0,0,1,-0.6060606060606233,0.15479888366627392)">
                <svg
                  viewBox="0 0 396 116"
                  data-background-color="#ffffff"
                  preserveAspectRatio="xMidYMid meet"
                  height="292"
                  width="1000"
                  xmlns="http://www.w3.org/2000/svg"
                  xmlnsXlink="http://www.w3.org/1999/xlink"
                >
                  <g
                    id="tight-bounds"
                    transform="matrix(1,0,0,1,0.2400000000000091,-0.061495446935907694)"
                  >
                    <svg
                      viewBox="0 0 395.52 116.1229908938718"
                      height="116.1229908938718"
                      width="395.52"
                    >
                      <g>
                        <svg
                          viewBox="0 0 584.8866524920275 171.72023518729486"
                          height="116.1229908938718"
                          width="395.52"
                        >
                          <g transform="matrix(1,0,0,1,189.36665249202753,48.48567609020646)">
                            <svg
                              viewBox="0 0 395.5199999999999 74.74888300688194"
                              height="74.74888300688194"
                              width="395.5199999999999"
                            >
                              <g id="textblocktransform">
                                <svg
                                  viewBox="0 0 395.5199999999999 74.74888300688194"
                                  height="74.74888300688194"
                                  width="395.5199999999999"
                                  id="textblock"
                                >
                                  <g>
                                    <svg
                                      viewBox="0 0 395.5199999999999 74.74888300688194"
                                      height="74.74888300688194"
                                      width="395.5199999999999"
                                    >
                                      <g transform="matrix(1,0,0,1,0,0)">
                                        <svg
                                          width="395.5199999999999"
                                          viewBox="3.05 -35.1 188.89 35.7"
                                          height="74.74888300688194"
                                          data-palette-color="#323131"
                                        >
                                          <path
                                            d="M16.6-35.1L16.6-35.1Q18.8-35.1 20.38-35 21.95-34.9 23.28-34.68 24.6-34.45 26-34.1L26-34.1 25.55-30.75Q24.05-30.9 22.78-31 21.5-31.1 20.05-31.15 18.6-31.2 16.6-31.2L16.6-31.2Q13.25-31.2 11.3-29.9 9.35-28.6 8.53-25.55 7.7-22.5 7.7-17.25L7.7-17.25Q7.7-12 8.53-8.95 9.35-5.9 11.3-4.6 13.25-3.3 16.6-3.3L16.6-3.3Q19.8-3.3 21.98-3.43 24.15-3.55 26.25-3.85L26.25-3.85 26.7-0.55Q24.55 0.05 22.28 0.33 20 0.6 16.6 0.6L16.6 0.6Q11.65 0.6 8.68-1.13 5.7-2.85 4.38-6.75 3.05-10.65 3.05-17.25L3.05-17.25Q3.05-23.85 4.38-27.75 5.7-31.65 8.68-33.38 11.65-35.1 16.6-35.1ZM47.2-24.95L47.2-24.95Q53.8-24.95 53.8-18.25L53.8-18.25 53.8 0 49.5 0 49.5-17.05Q49.5-19.5 48.72-20.43 47.95-21.35 46.05-21.35L46.05-21.35Q43.8-21.35 41.55-20.3 39.3-19.25 36.2-17.25L36.2-17.25 36-20.3Q38.85-22.45 41.65-23.7 44.45-24.95 47.2-24.95ZM32.4-35L36.65-35 36.7-25.35Q36.7-23.7 36.57-22.25 36.45-20.8 36.2-19.7L36.2-19.7 36.65-18.95 36.65 0 32.4 0 32.4-35ZM72.95-24.95L72.95-24.95Q75.65-24.95 77.52-24.23 79.4-23.5 80.34-21.8 81.3-20.1 81.3-17.15L81.3-17.15 81.3 0 77.95 0 77.3-5.3 77-5.85 77-17.15Q77-19.4 75.97-20.38 74.95-21.35 72.05-21.35L72.05-21.35Q70.15-21.35 67.27-21.15 64.39-20.95 61.59-20.7L61.59-20.7 61.2-23.85Q62.9-24.15 64.92-24.4 66.95-24.65 69.05-24.8 71.15-24.95 72.95-24.95ZM66.84-15L79.3-15 79.25-11.8 67.59-11.75Q65.84-11.7 65.14-10.83 64.45-9.95 64.45-8.4L64.45-8.4 64.45-6.85Q64.45-4.95 65.34-4.08 66.25-3.2 68.25-3.2L68.25-3.2Q69.65-3.2 71.42-3.73 73.2-4.25 75-5.35 76.8-6.45 78.3-8.15L78.3-8.15 78.3-5Q77.75-4.3 76.72-3.38 75.7-2.45 74.27-1.58 72.84-0.7 71.12-0.13 69.4 0.45 67.4 0.45L67.4 0.45Q65.25 0.45 63.59-0.33 61.95-1.1 61.02-2.63 60.09-4.15 60.09-6.35L60.09-6.35 60.09-9Q60.09-11.85 61.87-13.43 63.65-15 66.84-15L66.84-15ZM90.74-31.55L94.99-31.55 94.99-6.7Q94.99-4.95 95.74-4.2 96.49-3.45 98.29-3.45L98.29-3.45 101.99-3.45 102.49-0.2Q101.69 0 100.64 0.15 99.59 0.3 98.59 0.38 97.59 0.45 96.99 0.45L96.99 0.45Q93.94 0.45 92.34-1.25 90.74-2.95 90.74-6.15L90.74-6.15 90.74-31.55ZM91.14-24.35L102.74-24.35 102.74-21 86.34-21 86.34-24.1 91.14-24.35ZM120.24-34.95L120.24-34.95Q124.39-34.95 126.82-34 129.24-33.05 130.29-30.73 131.34-28.4 131.34-24.15L131.34-24.15Q131.34-19.9 130.31-17.55 129.29-15.2 126.97-14.28 124.64-13.35 120.74-13.35L120.74-13.35Q118.64-13.35 116.72-13.45 114.79-13.55 113.19-13.73 111.59-13.9 110.47-14.1 109.34-14.3 108.89-14.45L108.89-14.45 109.04-17.15Q111.69-17.15 114.54-17.15 117.39-17.15 120.19-17.15L120.19-17.15Q122.69-17.2 124.17-17.78 125.64-18.35 126.27-19.88 126.89-21.4 126.89-24.15L126.89-24.15Q126.89-26.95 126.27-28.45 125.64-29.95 124.17-30.55 122.69-31.15 120.19-31.15L120.19-31.15Q116.09-31.15 113.12-31.1 110.14-31.05 109.09-30.95L109.09-30.95 108.39-34.5Q110.29-34.7 111.94-34.8 113.59-34.9 115.54-34.93 117.49-34.95 120.24-34.95ZM108.39-34.5L112.79-34.5 112.79 0 108.39 0 108.39-34.5ZM150.19-34.95L150.19-34.95Q153.89-34.95 156.46-34.05 159.04-33.15 160.61-31.1 162.19-29.05 162.91-25.65 163.64-22.25 163.64-17.25L163.64-17.25Q163.64-12.25 162.91-8.85 162.19-5.45 160.61-3.4 159.04-1.35 156.46-0.45 153.89 0.45 150.19 0.45L150.19 0.45Q146.64 0.45 143.61 0.33 140.59 0.2 137.89 0L137.89 0 139.79-3.6Q141.89-3.55 144.46-3.48 147.04-3.4 150.19-3.4L150.19-3.4Q153.49-3.4 155.44-4.67 157.39-5.95 158.21-8.97 159.04-12 159.04-17.25L159.04-17.25Q159.04-22.5 158.21-25.53 157.39-28.55 155.44-29.85 153.49-31.15 150.19-31.15L150.19-31.15Q147.09-31.15 144.61-31.1 142.14-31.05 139.79-31L139.79-31 137.89-34.5Q140.59-34.7 143.61-34.83 146.64-34.95 150.19-34.95ZM137.89-34.5L142.29-34.5 142.29 0 137.89 0 137.89-34.5ZM177.64-34.55L177.64-34.55Q180.04-34.55 182.49-34.52 184.94-34.5 187.34-34.45 189.74-34.4 191.94-34.2L191.94-34.2 191.69-30.8 178.74-30.8Q176.99-30.8 176.19-30.03 175.39-29.25 175.39-27.5L175.39-27.5 175.39 0 170.99 0 170.99-28.35Q170.99-31.3 172.79-32.93 174.59-34.55 177.64-34.55ZM171.84-15.95L171.84-19.5 189.79-19.5 189.79-15.95 171.84-15.95Z"
                                            opacity="1"
                                            transform="matrix(1,0,0,1,0,0)"
                                            fill="#323131"
                                            className="wordmark-text-0"
                                            data-fill-palette-color="primary"
                                            id="text-0"
                                          ></path>
                                        </svg>
                                      </g>
                                    </svg>
                                  </g>
                                </svg>
                              </g>
                            </svg>
                          </g>
                          <g>
                            <svg
                              viewBox="0 0 171.72023518729486 171.72023518729486"
                              height="171.72023518729486"
                              width="171.72023518729486"
                            >
                              <g>
                                <svg></svg>
                              </g>
                              <g id="icon-0">
                                <svg
                                  viewBox="0 0 171.72023518729486 171.72023518729486"
                                  height="171.72023518729486"
                                  width="171.72023518729486"
                                >
                                  <g>
                                    <rect
                                      width="156.13821384622554"
                                      height="156.13821384622554"
                                      x="7.791010670534661"
                                      y="7.791010670534661"
                                      fill="#2563eb"
                                      data-fill-palette-color="accent"
                                    ></rect>
                                    <rect
                                      width="156.13821384622554"
                                      height="156.13821384622554"
                                      x="15.582021341069336"
                                      y="-1.3322676295501878e-14"
                                      fill="#2563eb"
                                      opacity="0.5"
                                      data-fill-palette-color="accent"
                                    ></rect>
                                  </g>
                                  <g transform="matrix(1,0,0,1,22.26003048724192,37.03226302242556)">
                                    <svg
                                      viewBox="0 0 127.20017421281102 97.65570914244374"
                                      height="97.65570914244374"
                                      width="127.20017421281102"
                                    >
                                      <g>
                                        <svg
                                          xmlns="http://www.w3.org/2000/svg"
                                          xmlnsXlink="http://www.w3.org/1999/xlink"
                                          version="1.1"
                                          x="0"
                                          y="0"
                                          viewBox="21.674999999999997 28.653000000000002 55.44900000000001 42.56999999999999"
                                          enableBackground="new 0 0 100 100"
                                          xmlSpace="preserve"
                                          height="97.65570914244374"
                                          width="127.20017421281102"
                                          className="icon-z$-0"
                                          data-fill-palette-color="background"
                                          id="z$-0"
                                        >
                                          <g
                                            fill="#ffffff"
                                            data-fill-palette-color="background"
                                          >
                                            <g
                                              fill="#ffffff"
                                              data-fill-palette-color="background"
                                            >
                                              <g
                                                fill="#ffffff"
                                                data-fill-palette-color="background"
                                              >
                                                <path
                                                  d="M61.287 67.735c-5.468 0-10.407-1.904-13.254-4.713-1.603-1.565-2.546-3.45-2.546-5.411 0-5.449 7.24-10.105 15.8-10.105 3.959 0 7.636 0.98 10.444 2.583 3.281 1.885 5.393 4.6 5.393 7.522 0 3.45-0.792 5.543-5.091 7.428-0.471 0.208-1.357 0.584-2.111 6.184l-5.788-3.582-0.396 0.057c-0.51 0.075-0.735 0.075-0.924 0.075-0.133 0-0.265 0-0.415-0.019C62.136 67.754 61.796 67.735 61.287 67.735z"
                                                  fill="#ffffff"
                                                  data-fill-palette-color="background"
                                                ></path>
                                                <path
                                                  d="M44.563 62.965c-1.149-0.075-2.262-0.208-3.355-0.377l-6.392 5.6-1.471-7.862c-7.032-3.054-11.67-8.39-11.67-14.479 0-9.483 11.388-17.194 25.414-17.194 14.046 0 25.434 7.711 25.434 17.194 0 0.49-0.019 0.961-0.094 1.414-3.055-1.622-6.92-2.583-11.143-2.583-10.237 0-18.288 5.694-18.288 12.934C42.999 59.515 43.564 61.344 44.563 62.965z"
                                                  fill="#ffffff"
                                                  data-fill-palette-color="background"
                                                ></path>
                                              </g>
                                            </g>
                                          </g>
                                        </svg>
                                      </g>
                                    </svg>
                                  </g>
                                </svg>
                              </g>
                            </svg>
                          </g>
                        </svg>
                      </g>
                      <defs></defs>
                    </svg>
                    <rect
                      width="395.52"
                      height="116.1229908938718"
                      fill="none"
                      stroke="none"
                      visibility="hidden"
                    ></rect>
                  </g>
                </svg>
              </g>
            </svg>
          </Link>

          <MobileNav isAuth={!!user} />

          <div className="hidden items-center space-x-4 sm:flex">
            {!user ? (
              <>
                <Link
                  href="/pricing"
                  className={buttonVariants({
                    variant: "ghost",
                    size: "sm",
                  })}
                >
                  Pricing
                </Link>
                <LoginLink
                  className={buttonVariants({
                    variant: "ghost",
                    size: "sm",
                  })}
                >
                  Sign in
                </LoginLink>
                <RegisterLink
                  className={buttonVariants({
                    size: "sm",
                  })}
                >
                  Get started <ArrowRight className="ml-1.5 h-5 w-5" />
                </RegisterLink>
              </>
            ) : (
              <>
                <Link
                  href="/dashboard"
                  className={buttonVariants({
                    variant: "ghost",
                    size: "sm",
                  })}
                >
                  Dashboard
                </Link>

                <UserAccountNav
                  name={
                    !user.given_name || !user.family_name
                      ? "Your Account"
                      : `${user.given_name} ${user.family_name}`
                  }
                  email={user.email ?? ""}
                  imageUrl={user.picture ?? ""}
                />
              </>
            )}
          </div>
        </div>
      </MaxWidthWrapper>
    </nav>
  );
};

export default Navbar;
